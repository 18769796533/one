<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./libs/zttb/iconfont.css">
    <link rel="stylesheet" href="./css/ydy.css">
    <link rel="stylesheet" href="./css/index.css">
</head>
<body>
    <!-- 顶部导航 -->
    <div class="topNav"></div>
    <!-- LOGO+搜索 -->
    <div class="logoNav"></div>
    <!-- 导航 -->
    <div class="nav"></div>
    <!-- 背景图 -->
    <div class="bg">
        <div class="login margin">
            <div class="loginbox">
                <div>
                    <h2>用户注册</h2>
                </div>
                <ul>
                    <li>
                        <span>
                            <i class="iconfont">&#xe644;</i>
                            <input type="text" placeholder="请输入用户名" id="reguser">
                        </span>
                    </li>
                    <li>
                        <span>
                            <i class="iconfont">&#xe644;</i>
                            <input type="text" placeholder="请设置登录密码，6-20个字符，须含数字和大小写字母" id="regpass">
                        </span>
                    </li>
                    <li>
                        <span>
                            <i class="iconfont">&#xe61c;</i>
                            <input type="text" placeholder="请输入11位手机号" id="regtel">
                        </span>
                    </li>
                    <li>
                        <span>
                            <i class="iconfont">&#xe644;</i>
                            <input type="text" placeholder="请输入邮箱" id="regem">
                        </span>
                    </li>
                </ul>
                <div class="zcbox">
                    <input type="checkbox">
                    <span>
                        我已经阅读并同意<a href=""> 会员注册协议</a> 和 <a href=""> 隐私保护政策</a>
                    </span>
                </div>
                <input type="button" value="注册" id="regbtn">
                <p></p>
            </div>
        </div>
    </div>
    <!-- 底部vip条 -->
    <div class="bvip"></div>
    <!-- 服务热线 -->
    <div class="hot clear"></div>
    <!-- 底部代码 -->
    <div class="fotter_b clear"></div>
    <!-- 结束 -->
    <div class="end clear"></div>
</body>
<script src="js/jquery2.2.4.js"></script>
<script src="js/load.js"></script>
<script>
    class Zhuce{
        constructor(){
            this.user = $("#reguser");
            this.pass = $("#regpass");
            this.tel = $("#regtel");
            this.email = $("#regemail");
            this.op = $(".loginbox p");
            this.btn = $("#regbtn");
            this.url = "http://api.icodeilife.cn:81/user";
            this.addEvent();
        }
        addEvent(){
            
            var that = this;
            this.btn.on("click",function(){
                that.load()
            })
        }
        load(){
            var that = this;
            $.ajax({
                url:this.url,
                data:{
                    type:"register",
                    user:this.user.val(),
                    pass:this.pass.val(),
                    tel:this.tel.val(),
                    email:this.email.val()
                },
                success:function(res){
                    
                    that.res = JSON.parse(res);
                    if(that.res.code == 1){
                        that.op.html("注册成功，5秒后跳转到<a href='login.html'>登录页面</a>")
                        setTimeout(function(){
                            location.href = "login.html"
                        },5000)
                    }else{
                        that.op.html("用户名重复，请重新注册")
                    }
                }
            })

        }
    }
    new Zhuce();


</script>
</html>